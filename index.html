<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Software and Service Fee Calculator</title>
  <style>
    /* Base styling */
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    /* Center header and text */
    h1,
    .subtitle,
    .explanation {
      text-align: center;
    }
    h1 {
      margin-top: 0;
      font-size: 2em;
    }
    .subtitle {
      font-size: 1em;
      margin: 10px 0;
      color: #333;
    }
    .explanation {
      font-size: 0.9em;
      color: #666;
      margin-bottom: 20px;
      line-height: 1.4;
    }
    /* Centered Readers Input */
    .reader-input {
      margin-bottom: 20px;
      text-align: center;
      font-size: 1em;
    }
    .reader-input label {
      font-weight: bold;
      margin-right: 10px;
    }
    .reader-input input[type="number"] {
      width: 60px;
      padding: 5px;
    }
    /* Top stats row */
    .stats-display {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      border-top: 1px solid #ddd;
      border-bottom: 1px solid #ddd;
      padding: 10px 0;
    }
    .stat-item {
      flex: 1;
      text-align: center;
    }
    .stat-title {
      display: block;
      font-size: 0.9em;
      color: #555;
      margin-bottom: 5px;
    }
    .stat-value {
      font-size: 1.8em;
      font-weight: bold;
      color: #007bff;
    }
    /* Slider styling */
    .slider-wrapper {
      position: relative;
      margin: 40px 0;
    }
    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 12px;
      background: #ddd;
      border-radius: 6px;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #007bff;
      cursor: pointer;
      border: none;
      margin-top: -6px; /* center thumb vertically */
    }
    input[type="range"]::-moz-range-thumb {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #007bff;
      cursor: pointer;
      border: none;
    }
    /* Slider tick marks container */
    .slider-marks {
      position: absolute;
      width: 100%;
      pointer-events: none;
    }
    /* Slider tick mark styles */
    .slider-mark {
      position: absolute;
      text-align: center;
      font-size: 0.75em;
      transform: translateX(-50%);
    }
    /* Regular tick marks (non-special) – shown below the slider */
    .slider-mark.normal {
      color: #999;
      top: 20px;
    }
    /* Special tick marks (min & max) – shown above the slider */
    .slider-mark.special {
      color: #d9534f;
      font-weight: bold;
      top: -25px;
    }
    /* Drop-down calculation info styling */
    #calcContainer {
      display: none;
      font-size: 0.9em;
      margin-top: 20px;
      text-align: left;
      border-top: 1px solid #ddd;
      padding-top: 20px;
    }
    #calcContainer p { 
      margin-bottom: 10px; 
    }
    /* Subtitle styling for min/max per reader */
    .subinfo {
      margin-left: 20px;
      font-style: italic;
      color: #555;
    }
    #toggleCalcButton {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1em;
    }
    #toggleCalcButton:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header, Subtitle, Explanation -->
    <h1>Software and Service Fee Calculator</h1>
    <p class="subtitle">Select your estimated monthly revenue below</p>
    <p class="explanation">
      The Software and Service Fee is 5% of Revenue<br />
      • A minimum of $10/month or maximum of $20/month per active Reader will be imposed for the monthly Software and Service fee.
    </p>

    <!-- Centered Readers Input -->
    <div class="reader-input">
      <label for="numReaders">Enter Number of Readers:</label>
      <input type="number" id="numReaders" min="1" value="5" />
    </div>

    <!-- Three-Column Stats Display -->
    <div class="stats-display">
      <div class="stat-item">
        <span class="stat-title">Monthly Revenue</span>
        <span id="revenueDisplayValue" class="stat-value">$0</span>
      </div>
      <div class="stat-item">
        <span class="stat-title">Monthly Cost</span>
        <span id="monthlyCostDisplay" class="stat-value">$0</span>
      </div>
      <div class="stat-item">
        <span class="stat-title">Monthly Cost per reader</span>
        <span id="monthlyCostPerReaderDisplay" class="stat-value">$0</span>
      </div>
    </div>

    <!-- Slider -->
    <div class="slider-wrapper">
      <input type="range" id="monthlyRevenue" step="100" value="0" />
      <div id="sliderMarks" class="slider-marks"></div>
    </div>

    <!-- Toggle Button & Calculations Info -->
    <button id="toggleCalcButton">Click here to see our calculations</button>
    <div id="calcContainer">
      <p><strong>5% of Revenue:</strong> The fee is calculated as 5% of your monthly revenue (Fee = 0.05 × Monthly Revenue).</p>
      <p><strong>Minimum and Maximum Thresholds:</strong> A minimum fee of $10 per reader and a maximum fee of $20 per reader apply. These thresholds are determined as follows:</p>
      <p class="subinfo"><strong>Min. per Reader:</strong> $10</p>
      <p class="subinfo"><strong>Max. per Reader:</strong> $20</p>
      <p>&nbsp;&nbsp;Minimum Threshold (Monthly Revenue) = (Number of Readers × $10) / 0.05</p>
      <p>&nbsp;&nbsp;Maximum Threshold (Monthly Revenue) = (Number of Readers × $20) / 0.05</p>
      <p><strong>Monthly Fee per Reader & Total Monthly Fee:</strong> The fee per reader is computed as (Monthly Revenue × 0.05) divided by the Number of Readers. It is then capped between $10 and $20 per reader, and the Total Monthly Fee is this per‑reader fee multiplied by the Number of Readers.</p>
    </div>
  </div>

  <script>
    // Helper: format tick values; abbreviate over 1000 with "k"
    function formatTick(value) {
      if (value < 1000) {
        return `$${value}`;
      } else {
        const kValue = value / 1000;
        return Number.isInteger(kValue) ? `$${kValue}k` : `$${kValue.toFixed(1)}k`;
      }
    }

    function updateCalculator() {
      // Retrieve number of readers and validate.
      let numReaders = parseInt(document.getElementById('numReaders').value);
      if (isNaN(numReaders) || numReaders < 1) {
        numReaders = 1;
        document.getElementById('numReaders').value = 1;
      }

      // Pricing parameters.
      const feePercentage = 0.05;
      const minPerReader = 10;
      const maxPerReader = 20;

      // Compute revenue thresholds where fee per reader caps are reached.
      let minThreshold = (minPerReader * numReaders) / feePercentage;
      let maxThreshold = (maxPerReader * numReaders) / feePercentage;

      // Determine scaling based on reader count:
      // ≤ 49: extension = $500, tick = $500.
      // 50–99: extension = $1,000, tick = $1,000.
      // ≥ 100: base extension/tick = $2,000 (for 100–149); every extra 50 adds $1,000.
      let rangeExtension = 500;
      let tickInterval = 500;
      if (numReaders < 50) {
        rangeExtension = 500;
        tickInterval = 500;
      } else if (numReaders < 100) {
        rangeExtension = 1000;
        tickInterval = 1000;
      } else {
        let extraGroups = Math.floor((numReaders - 100) / 50);
        rangeExtension = 2000 + extraGroups * 1000;
        tickInterval = 2000 + extraGroups * 1000;
      }

      // Set slider range dynamically.
      let sliderMin = minThreshold - rangeExtension;
      let sliderMax = maxThreshold + rangeExtension;
      if (sliderMin < 0) sliderMin = 0;
      const slider = document.getElementById('monthlyRevenue');
      slider.min = sliderMin;
      slider.max = sliderMax;

      // Ensure current slider value is within bounds.
      let currentRevenue = parseFloat(slider.value);
      if (currentRevenue < sliderMin) {
        currentRevenue = sliderMin;
        slider.value = sliderMin;
      } else if (currentRevenue > sliderMax) {
        currentRevenue = sliderMax;
        slider.value = sliderMax;
      }

      // Calculate fee per reader based on 5% of monthly revenue.
      let feePerReader = (currentRevenue * feePercentage) / numReaders;
      if (feePerReader < minPerReader) feePerReader = minPerReader;
      if (feePerReader > maxPerReader) feePerReader = maxPerReader;
      let totalCost = feePerReader * numReaders;

      // Update the stats display.
      document.getElementById('revenueDisplayValue').innerText = `$${currentRevenue.toLocaleString()}`;
      document.getElementById('monthlyCostDisplay').innerText = `$${totalCost.toFixed(2)}`;
      document.getElementById('monthlyCostPerReaderDisplay').innerText = `$${feePerReader.toFixed(2)}`;

      // Generate slider tick marks.
      const sliderMarksContainer = document.getElementById('sliderMarks');
      sliderMarksContainer.innerHTML = "";
      const range = sliderMax - sliderMin;
      for (let value = sliderMin; value <= sliderMax; value += tickInterval) {
        let mark = document.createElement("span");
        let isSpecial = false;
        let specialLabel = "";
        if (Math.abs(value - minThreshold) < tickInterval / 2) {
          isSpecial = true;
          specialLabel = " (Minimum)";
        } else if (Math.abs(value - maxThreshold) < tickInterval / 2) {
          isSpecial = true;
          specialLabel = " (Maximum)";
        }
        if (isSpecial) {
          mark.classList.add("slider-mark", "special");
          mark.innerText = formatTick(value) + specialLabel;
        } else {
          mark.classList.add("slider-mark", "normal");
          mark.innerText = formatTick(value);
        }
        let posPercent = ((value - sliderMin) / range) * 100;
        mark.style.left = posPercent + "%";
        if (!isSpecial) {
          mark.style.top = "20px";
        }
        sliderMarksContainer.appendChild(mark);
      }
    }

    // Event listeners for dynamic updates.
    document.getElementById('monthlyRevenue').addEventListener("input", updateCalculator);
    document.getElementById('numReaders').addEventListener("input", updateCalculator);

    // Toggle for Calculation Details.
    document.getElementById("toggleCalcButton").addEventListener("click", function () {
      const calcContainer = document.getElementById("calcContainer");
      if (calcContainer.style.display === "none" || calcContainer.style.display === "") {
        calcContainer.style.display = "block";
        this.innerText = "Hide calculations";
      } else {
        calcContainer.style.display = "none";
        this.innerText = "Click here to see our calculations";
      }
    });

    // Initialize on page load.
    updateCalculator();
  </script>
</body>
</html>